import javax.xml.parsers.DocumentBuilderFactory
import java.io.StringReader
import org.xml.sax.InputSource

object XxeExample {
  def parseXml(xml: String): Unit = {
    val dbFactory = DocumentBuilderFactory.newInstance()
    // VULNERABLE: XXE enabled by default in some parsers
    val dBuilder = dbFactory.newDocumentBuilder()
    val doc = dBuilder.parse(new InputSource(new StringReader(xml)))
    println(doc.getDocumentElement.getNodeName)
  }
}
